# AWSアカウントを作成しよう

## 流れ

1. AWSアカウント作成
2. クーポンコードの入力
3. IAMユーザ作成

## 1. AWSアカウント作成

AWS公式サイトにある、[AWS アカウント作成の流れ](https://aws.amazon.com/jp/register-flow/)にしたがって、
AWSアカウントを作成しましょう。

### 必要なもの

- Eメールアドレス
    - AWSアカウント名になります
- クレジットカード
    - 無料利用枠を超えた場合は、クレジットカードにて利用料が請求されます
- 携帯電話
    - アカウント作成途中に、日本語自動音声電話によるアカウント認証があります

### 補足

AWSアカウントを作成する際に使用したEメールアドレスとパスワードによる組合せは、
「ルートユーザー認証情報」とも呼ばれます。

- AWSへの普段のアクセスには、ルートアカウント認証情報を使用しない
- ルートアカウント認証情報は誰とも共有しない、譲渡しない

## 2. クーポンコードの入力

AWS公式サイトにある、[AWS クーポンの適用方法](https://aws.amazon.com/jp/apply-coupon/)にしたがって、
AWSのクーポンコードを登録しましょう。

## 3. IAMユーザ作成

ルートアカウントでの作業は、なんでもできる権限を持っているため、
ルートアカウントが必要な作業時のみ使用し、
普段はIAMユーザにて作業することが強く推奨されます。

今回は、管理用の権限をもつIAMユーザを作成し、
そのIAMユーザにてハンズオンを進めていきます。

### 1. AWSマネジメントコンソールにアクセスする

1. [AWSのWebサイト](https://aws.amazon.com/jp/)にアクセスし、
    サイト右上にある「コンソールへログイン」をクリックします。
2. サインイン画面です。
    AWSアカウントのEメールアドレスには、
    AWSアカウントを作成したメールアドレスを入れます。
    「次へ」をクリックすると、パスワードを入力するフォームが表示されますので、
    ルートアカウントのパスワードを入れます。
    必要事項を入力したら、「サインイン」をクリックします。
3. AWSマネジメントコンソールのトップページが開いたら完了です。

### 2. IAMユーザを作成する

1. AWSマネジメントコンソールで「サービス」から「IAM」をクリックします。
    - Identity and Access Managementのダッシュボード画面が表示されます。
2. 「ユーザー」をクリックし、「ユーザーを追加」をクリックします。
    「ユーザーを追加」画面が表示されます。
3. 必要事項を入力します。
    - ユーザー名: 適宜入力してください
    - アクセスの種類:
        「AWSマネジメントコンソールへのアクセス」のみチェックを入れてください
    - コンソールのパスワード:
        「カスタムパスワード」を選択し、
        テキストボックスにパスワードを適宜入力してください
    - パスワードのリセットが必要: チェックを外してください
4. 「次のステップ: アクセス権限」をクリックしてください。
    「アクセス許可の設定」画面が表示されます。
5. 「ユーザーをグループに追加」が選択されていることを確認し、
    「グループの作成」をクリックします。
    「グループの作成」ダイアログボックスが表示されます。
6. 必要事項を入力します。
    - グループ名: 今回は「admin」とします。
    - 「ポリシーのフィルタ」の検索のテキストボックスに
        「AdministratorAccess」を入力し、下のポリシー名一覧にある
        「AdministratorAccess」の左側のチェックボックスにチェックを入れます。
7. 「グループの作成」をクリックします。
    「アクセス許可の設定」画面に戻ります。グループ一覧に「admin」があり、
    左側のチェックボックスにチェックが入っていることを確認してください。
8. 「次のステップ: タグ」をクリックします。
    「タグの追加(オプション)」画面が表示されます。
9. 「次のステップ: 確認」をクリックします。
    「確認」画面が表示されます。
    - 今回は特にタグを追加せずに先に進みます。
10. 「ユーザーの作成」をクリックします。
    ユーザーの作成に成功すると、作成したユーザの一覧が表示されます。
    - 「.csvのダウンロード」をクリックすると、
        認証情報のcsvファイルがダウンロードできます。
        このファイルはこの画面でしかダウンロードできません。
    - 「Eメールの送信」をクリックすると、
        認証情報をEメール宛に通知することができます。
11. 「閉じる」をクリックします。
    「IAMユーザー一覧」画面が表示されます。
    作成したIAMユーザが一覧の中にあると思います。

### 3. IAMユーザのサインイン方法

1. 「ダッシュボード」をクリックします。
    - Identity and Access Managementのダッシュボード画面が表示されます。
2. 「IAMユーザーのサインインリンク」のURLにアクセスすると、
    このAWSルートアカウント配下のIAMユーザのログイン画面が表示されます。
    - `https://<AWSアカウントID>.signin.aws.amazon.com/console`
        というURLになってます。
3. 「カスタマイズ」をクリックすると、
    `<AWSアカウントID>`の部分を任意のエイリアス文字列に変更できます。
4. 「IAMユーザーのサインインリンク」のURLをブラウザの別タブで開いてみましょう。
    IAMユーザーのサインイン画面が開きます。
    - アカウント: AWSアカウントIDもしくはアカウントエイリアス文字列を入力します。
    - ユーザー名: IAMユーザ名を入力します。
    - パスワード: IAMユーザのパスワードを入力します。

以上です。
では、ハンズオンをやってみましょう！

---

## ログイン画面の切り替えについて

- ルートアカウントでサインインする場合は、
    「ルートアカウント認証情報を使用してサインイン」をクリックします。
- 「ルートユーザーサインイン」画面からIAMユーザでログインしたい場合、
    「別のアカウントにサインインする」をクリックし、
    「AWSアカウントのEメールアドレス」のテキストボックス内に
    「AWSアカウントID」もしくは「アカウントエイリアス」文字列を入力し、
    「次へ」をクリックすると、IAMユーザのサインイン画面が表示されます。

## AWSアカウントについての補足

- ルートアカウントでしかできない操作もあります。
    [こちらのページ](https://dev.classmethod.jp/etc/only_aws_account/)
    などをご参考ください。
- ルートアカウントはMFAを導入して保護しましょう。
    IAMユーザにもMFAを導入できます。
- ルートアカウントにアクセスキーとシークレットキーを設定しないでください。
    以前は「Amazon Product Advertising API」を使用する際にルートアカウントのアクセスキーが必要でしたが、現在は「ProductAdvertisingAPI」に関するIAMポリシーが導入できますので、ルートアカウントのアクセスキーを使用する必要がありません。

## 参考

- [ID 管理の概要: ユーザー - AWS Identity and Access Management](https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/introduction_identity-management.html)
- [IAM のベストプラクティス - AWS Identity and Access Management](https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/best-practices.html)
- [AWS アカウントのルートユーザー 認証情報が必要な AWS タスク - アマゾンウェブサービス](https://docs.aws.amazon.com/ja_jp/general/latest/gr/aws_tasks-that-require-root.html)
- [AWSアカウントでしかできないことをまとめてみた | DevelopersIO](https://dev.classmethod.jp/etc/only_aws_account/)
- [責任共有モデル - アマゾンウェブサービス(AWS)](https://aws.amazon.com/jp/compliance/shared-responsibility-model/)
